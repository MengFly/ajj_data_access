<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.akxy.mapper.AreaTopDataInfoMapper">
	<resultMap id="BaseResultMap"
		type="com.akxy.entity.AreaTopDataInfo">
		<result column="AREA_ID" property="areaId" jdbcType="DECIMAL" />
		<result column="ACQUISITION_TIME" property="acquisitionTime"
			jdbcType="TIMESTAMP" />
		<result column="AREA_VALUE" property="areaValue"
			jdbcType="DECIMAL" />
		<result column="AREA_LEVEL" property="areaLevel"
			jdbcType="VARCHAR" />
		<result column="STRESS_VALUE" property="stressValue"
			jdbcType="DECIMAL" />
		<result column="QUAKE_VALUE" property="quakeValue"
			jdbcType="DECIMAL" />
		<result column="MEMO" property="memo" jdbcType="VARCHAR" />
	</resultMap>
	<insert id="insert"
		parameterType="com.akxy.entity.AreaTopDataInfo">
		insert into AREA_TOP_DATA_INFO (AREA_ID, ACQUISITION_TIME, AREA_VALUE,
		AREA_LEVEL, STRESS_VALUE, QUAKE_VALUE,
		MEMO)
		values (#{areaId,jdbcType=DECIMAL}, #{acquisitionTime,jdbcType=TIMESTAMP},
		#{areaValue,jdbcType=DECIMAL},
		#{areaLevel,jdbcType=OTHER}, #{stressValue,jdbcType=DECIMAL}, #{quakeValue,jdbcType=DECIMAL},
		#{memo,jdbcType=OTHER})
	</insert>

	<!-- 批量插入AREA_TOP_DATA_INFO -->
	<insert id="insertGroupData" parameterType="java.util.List">
		INSERT INTO AREA_TOP_DATA_INFO (
			AREA_ID,
			ACQUISITION_TIME,
			AREA_VALUE,
			AREA_LEVEL,
			STRESS_VALUE,
			QUAKE_VALUE,
			MEMO
		)
		<foreach collection="list" item="item" index="index" open="("
			separator="union" close=")">
			SELECT
				#{item.areaId,jdbcType = DECIMAL},
				#{item.acquisitionTime,jdbcType = TIMESTAMP},
				#{item.areaValue,jdbcType = DECIMAL},
				#{item.areaLevel,jdbcType = VARCHAR},
				#{item.stressValue,jdbcType = DECIMAL},
				#{item.quakeValue,jdbcType =DECIMAL},
				#{item.memo,jdbcType = VARCHAR}
			FROM
			dual
		</foreach>
	</insert>

	<!-- 根据AreaId判断是否存在该区域数据 -->
	<select id="judegContain" resultType="java.lang.Integer">
		select count(*) from AREA_TOP_DATA_INFO where AREA_ID=#{areaId,jdbcType = DECIMAL}
	</select>
	
	<!-- 更新已存在的数据 -->
	<update id="updateTopData">
		UPDATE AREA_TOP_DATA_INFO SET
			ACQUISITION_TIME=#{acquisitionTime,jdbcType=TIMESTAMP},
			AREA_VALUE=#{areaValue,jdbcType=DECIMAL},
			AREA_LEVEL=#{areaLevel,jdbcType=VARCHAR},
			STRESS_VALUE=#{stressValue,jdbcType=DECIMAL},
			QUAKE_VALUE=#{quakeValue,jdbcType=DECIMAL},
			MEMO=#{memo,jdbcType=VARCHAR}
		WHERE AREA_ID=#{areaId,jdbcType=DECIMAL}
	</update>
	
	<!-- 获取全矿预警 -->
	<select id="findAreaValue" resultType="java.lang.Short">
		SELECT AREA_VALUE FROM AREA_TOP_DATA_INFO WHERE AREA_ID=0
	</select>
	
</mapper>